(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16965,        456]
NotebookOptionsPosition[     16012,        423]
NotebookOutlinePosition[     16358,        438]
CellTagsIndexPosition[     16315,        435]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"c", "=", "300000000"}], "\[IndentingNewLine]", 
 RowBox[{"source", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"truesource", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"700000000", ",", "4000000000", ",", 
    RowBox[{"-", "4000000000"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"v1", " ", "=", "  ", 
  RowBox[{"{", 
   RowBox[{
   "4730.5250632253128", ",", "2143.6350639647035", ",", 
    "2947.0247509642622"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"v2", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
   "2688.5168406593225", ",", "3268.5073107800017", ",", 
    "4955.5059056521886"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"v3", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
   "1493.7551815499342", ",", "4186.350167350075", ",", 
    "4911.5723464226221"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"v4", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
   "1356.56143368993", ",", "1768.0281688310338", ",", "3622.9812650117005"}],
    "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"sat1", " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "5935802.5687354617"}], ",", " ", "24717254.051876262", ",", 
    " ", "2767910.195097459"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"sat2", " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "22012417.926170126"}], ",", " ", "12713373.157570107", ",", 
    " ", "10264559"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"sat3", " ", "=", 
  RowBox[{"{", 
   RowBox[{"4678350.1451920457", ",", " ", "24985784.756916914", ",", " ", 
    RowBox[{"-", "16312345"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"sat4", " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "14485131.6116681"}], ",", " ", "20889168.537609473", ",", 
    " ", "9169112"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"w0", " ", "=", " ", "600000000"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v1", ".", 
          RowBox[{"(", 
           RowBox[{"truesource", "-", "sat1"}], ")"}]}], "/", 
         RowBox[{"Norm", "[", 
          RowBox[{"truesource", "-", "sat1"}], "]"}]}], ")"}], "/", "c"}]}], 
     ")"}], "*", "w0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dw12", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v1", ".", 
          RowBox[{"(", 
           RowBox[{"truesource", "-", "sat1"}], ")"}]}], "/", 
         RowBox[{"Norm", "[", 
          RowBox[{"truesource", "-", "sat1"}], "]"}]}], ")"}], " ", "+", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2", ".", 
          RowBox[{"(", 
           RowBox[{"truesource", "-", "sat2"}], ")"}]}], "/", 
         RowBox[{"Norm", "[", 
          RowBox[{"truesource", "-", "sat2"}], "]"}]}], ")"}]}], ")"}], "/", 
     "c"}], "*", "w0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dw13", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v1", ".", 
          RowBox[{"(", 
           RowBox[{"truesource", "-", "sat1"}], ")"}]}], "/", 
         RowBox[{"Norm", "[", 
          RowBox[{"truesource", "-", "sat1"}], "]"}]}], ")"}], " ", "+", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v3", ".", 
          RowBox[{"(", 
           RowBox[{"truesource", "-", "sat3"}], ")"}]}], "/", 
         RowBox[{"Norm", "[", 
          RowBox[{"truesource", "-", "sat3"}], "]"}]}], ")"}]}], ")"}], "/", 
     "c"}], "*", "w0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dw14", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v1", ".", 
          RowBox[{"(", 
           RowBox[{"truesource", "-", "sat1"}], ")"}]}], "/", 
         RowBox[{"Norm", "[", 
          RowBox[{"truesource", "-", "sat1"}], "]"}]}], ")"}], " ", "+", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v4", ".", 
          RowBox[{"(", 
           RowBox[{"truesource", "-", "sat4"}], ")"}]}], "/", 
         RowBox[{"Norm", "[", 
          RowBox[{"truesource", "-", "sat4"}], "]"}]}], ")"}]}], ")"}], "/", 
     "c"}], "*", "w0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmp1", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v1", ".", "source"}], "-", 
        RowBox[{"v2", ".", "source"}]}], ")"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"c", "+", 
       RowBox[{"v1", ".", "source"}]}], ")"}]}], "-", 
    RowBox[{"dw12", "/", "w1"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tmp2", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v1", ".", "source"}], "-", 
        RowBox[{"v3", ".", "source"}]}], ")"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"c", "+", 
       RowBox[{"v3", ".", "source"}]}], ")"}]}], "-", 
    RowBox[{"dw13", "/", "w1"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tmp3", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v1", ".", "source"}], "-", 
        RowBox[{"v4", ".", "source"}]}], ")"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"c", "+", 
       RowBox[{"v4", ".", "source"}]}], ")"}]}], "-", 
    RowBox[{"dw14", "/", "w1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sys", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"tmp1", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", " ", 
    RowBox[{"tmp2", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", " ", 
    RowBox[{"tmp3", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Sys", "[", 
  RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.8286119038118305`*^9, {3.8286119857348824`*^9, 3.828612029240653*^9}, 
   3.828612105454814*^9, 3.8286122279082503`*^9, 3.82861227175776*^9, {
   3.8286123410742226`*^9, 3.8286125710506597`*^9}, {3.8286126321050386`*^9, 
   3.828612784899233*^9}, {3.828612840610181*^9, 3.8286129105236626`*^9}, {
   3.8286129492188034`*^9, 3.8286129505526514`*^9}}],

Cell[BoxData["300000000"], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.8286129706043987`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.8286129706073914`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"700000000", ",", "4000000000", ",", 
   RowBox[{"-", "4000000000"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.828612970612317*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4730.525063225313`", ",", "2143.6350639647035`", ",", 
   "2947.0247509642622`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.8286129706143255`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2688.5168406593225`", ",", "3268.5073107800017`", ",", 
   "4955.505905652189`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.828612970620908*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1493.7551815499342`", ",", "4186.350167350075`", ",", 
   "4911.572346422622`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.8286129706237717`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1356.56143368993`", ",", "1768.0281688310338`", ",", 
   "3622.9812650117005`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.8286129706267653`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "5.935802568735462`*^6"}], ",", "2.471725405187626`*^7", ",", 
   "2.767910195097459`*^6"}], "}"}]], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.828612970632027*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.2012417926170126`*^7"}], ",", "1.2713373157570107`*^7", 
   ",", "10264559"}], "}"}]], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.8286129706350193`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.678350145192046`*^6", ",", "2.4985784756916914`*^7", ",", 
   RowBox[{"-", "16312345"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.8286129706413355`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.44851316116681`*^7"}], ",", "2.0889168537609473`*^7", ",", 
   "9169112"}], "}"}]], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.8286129706445427`*^9}}],

Cell[BoxData["600000000"], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.8286129706475368`*^9}}],

Cell[BoxData[
 RowBox[{"7.677324450937435`*^-6", "+", 
  FractionBox[
   RowBox[{
    RowBox[{"2042.0082225659903`", " ", "x"}], "-", 
    RowBox[{"1124.8722468152982`", " ", "y"}], "-", 
    RowBox[{"2008.4811546879264`", " ", "z"}]}], 
   RowBox[{"300000000", "+", 
    RowBox[{"4730.525063225313`", " ", "x"}], "+", 
    RowBox[{"2143.6350639647035`", " ", "y"}], "+", 
    RowBox[{"2947.0247509642622`", " ", "z"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"3373.963629535383`", " ", "x"}], "+", 
    RowBox[{"375.6068951336697`", " ", "y"}], "-", 
    RowBox[{"675.9565140474383`", " ", "z"}]}], 
   RowBox[{"300000000", "+", 
    RowBox[{"1356.56143368993`", " ", "x"}], "+", 
    RowBox[{"1768.0281688310338`", " ", "y"}], "+", 
    RowBox[{"3622.9812650117005`", " ", "z"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"3236.7698816753787`", " ", "x"}], "-", 
    RowBox[{"2042.7151033853715`", " ", "y"}], "-", 
    RowBox[{"1964.5475954583599`", " ", "z"}]}], 
   RowBox[{"300000000", "+", 
    RowBox[{"1493.7551815499342`", " ", "x"}], "+", 
    RowBox[{"4186.350167350075`", " ", "y"}], "+", 
    RowBox[{"4911.572346422622`", " ", "z"}]}]]}]], "Output",
 CellChangeTimes->{
  3.828611782654539*^9, 3.828611905091231*^9, {3.8286119897003756`*^9, 
   3.828612029888364*^9}, 3.8286121084506674`*^9, 3.8286122300446844`*^9, {
   3.8286126338997583`*^9, 3.8286127159209566`*^9}, {3.8286127724662733`*^9, 
   3.828612785388912*^9}, {3.828612841622611*^9, 3.828612911217646*^9}, {
   3.8286129517197328`*^9, 3.828612970653293*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8286118111081066`*^9, 3.8286118326953807`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"tmp1", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"tmp2", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"tmp3", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Equal]", "0"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8286119147903337`*^9, 3.8286119569616528`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", "0.12013111012570778`"}]}], ",", 
    RowBox[{"y", "\[Rule]", 
     RowBox[{"-", "0.6970968829824293`"}]}], ",", 
    RowBox[{"z", "\[Rule]", "0.690477377774687`"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8286119588490405`*^9, {3.8286119912802973`*^9, 3.82861203173393*^9}, 
   3.828612109899731*^9, 3.82861223477971*^9, {3.8286126363988805`*^9, 
   3.8286126889847183`*^9}, {3.8286128453890824`*^9, 
   3.8286128721041603`*^9}, {3.828612967489194*^9, 3.828612973206134*^9}}]
}, Open  ]]
},
WindowSize->{958, 988},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 6560, 190, 483, "Input"],
Cell[7143, 214, 409, 6, 30, "Output"],
Cell[7555, 222, 456, 8, 30, "Output"],
Cell[8014, 232, 499, 9, 30, "Output"],
Cell[8516, 243, 516, 10, 30, "Output"],
Cell[9035, 255, 514, 10, 30, "Output"],
Cell[9552, 267, 515, 10, 30, "Output"],
Cell[10070, 279, 515, 10, 30, "Output"],
Cell[10588, 291, 537, 10, 34, "Output"],
Cell[11128, 303, 528, 10, 34, "Output"],
Cell[11659, 315, 523, 9, 34, "Output"],
Cell[12185, 326, 525, 10, 34, "Output"],
Cell[12713, 338, 409, 6, 30, "Output"],
Cell[13125, 346, 1549, 34, 86, "Output"]
}, Open  ]],
Cell[14689, 383, 96, 1, 30, "Input"],
Cell[CellGroupData[{
Cell[14810, 388, 592, 17, 47, "Input"],
Cell[15405, 407, 591, 13, 87, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

